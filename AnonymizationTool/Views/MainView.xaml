<fluent:RibbonWindow x:Class="AnonymizationTool.Views.MainView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:fluent="urn:fluent-ribbon"
    xmlns:xceed="http://schemas.xceed.com/wpf/xaml/toolkit"
    xmlns:converters="clr-namespace:AnonymizationTool.Converters"
    xmlns:selectors="clr-namespace:AnonymizationTool.Selectors"
                     xmlns:behaviors="clr-namespace:AnonymizationTool.Behaviors"
                     xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    mc:Ignorable="d"
    Title="Anonymisierungs-Tool" Height="500" Width="1000"
    DataContext="{Binding Source={StaticResource ViewModelLocator}, Path=Main}">

    <fluent:RibbonWindow.Resources>
        <CollectionViewSource x:Key="GroupedStudents" Source="{Binding Students}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Grade" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </fluent:RibbonWindow.Resources>

    <DockPanel>
        <fluent:Ribbon DockPanel.Dock="Top" IsQuickAccessToolBarMenuDropDownVisible="False" IsQuickAccessToolBarVisible="False">
            <fluent:Ribbon.Menu>
                <fluent:Backstage>
                    <fluent:BackstageTabControl>
                        <fluent:BackstageTabItem Header="Einstellungen" DataContext="{Binding Source={StaticResource ViewModelLocator}, Path=Settings}">
                            <fluent:BackstageTabItem.Icon>
                                <!-- This file was generated by the AiToXaml tool.-->
                                <!-- Tool Version: 14.0.22307.0 -->
                                <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,32C15.425,32,14.823,31.963,14.161,31.887L12.922,31.746 11.333,27.275 7.051,29.309 6.075,28.537C5.111,27.773,4.233,26.897,3.465,25.928L2.69,24.951 4.725,20.67 0.254,19.08 0.112,17.842C0.0370000000000008,17.178 0,16.576 0,16 0,15.424 0.0370000000000008,14.822 0.112,14.158L0.254,12.92 4.725,11.33 2.69,7.049 3.465,6.072C4.233,5.104,5.111,4.225,6.075,3.463L7.051,2.691 11.333,4.725 12.922,0.254000000000001 14.161,0.113C14.823,0.036999999999999 15.425,0 16,0 16.58,0 17.184,0.036999999999999 17.846,0.113L19.083,0.257999999999999 20.671,4.725 24.951,2.691 25.927,3.463C26.893,4.229,27.771,5.107,28.537,6.074L29.31,7.051 27.275,11.33 31.746,12.92 31.888,14.158C31.963,14.822 32,15.424 32,16 32,16.576 31.963,17.178 31.888,17.842L31.746,19.08 27.275,20.67 29.31,24.949 28.537,25.924C27.771,26.893,26.893,27.772,25.927,28.535L24.951,29.309 20.671,27.275 19.082,31.742 17.846,31.887C17.184,31.963,16.58,32,16,32" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M16,13C14.344,13 13,14.344 13,16 13,17.656 14.344,19 16,19 17.656,19 19,17.656 19,16 19,14.344 17.656,13 16,13 M16,10C12.686,10 10,12.686 10,16 10,19.314 12.686,22 16,22 19.314,22 22,19.314 22,16 22,12.686 19.314,10 16,10 M25.428,19.205C25.287,19.619,25.127,20.018,24.936,20.406L26.969,24.684C26.299,25.529,25.533,26.297,24.686,26.967L20.406,24.934C20.02,25.127,19.619,25.285,19.205,25.428L17.615,29.898C17.084,29.961 16.547,30 16,30 15.455,30 14.918,29.961 14.389,29.9L12.799,25.428C12.385,25.287,11.982,25.127,11.596,24.936L7.316,26.969C6.469,26.297,5.703,25.531,5.031,24.684L7.064,20.406C6.873,20.018,6.713,19.619,6.572,19.205L2.1,17.613C2.039,17.084 2,16.547 2,16 2,15.453 2.039,14.916 2.1,14.385L6.572,12.795C6.713,12.381,6.873,11.981,7.064,11.594L5.031,7.314C5.703,6.469,6.469,5.701,7.316,5.031L11.596,7.064C11.982,6.871,12.383,6.713,12.799,6.57L14.389,2.1C14.918,2.039 15.455,2 16,2 16.547,2 17.084,2.039 17.615,2.1L19.205,6.572C19.619,6.713,20.02,6.873,20.406,7.064L24.686,5.031C25.533,5.703,26.299,6.469,26.969,7.316L24.936,11.594C25.127,11.981,25.287,12.381,25.428,12.795L29.9,14.385C29.961,14.916 30,15.453 30,16 30,16.547 29.961,17.084 29.9,17.613z" />
                                                            <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M16,19C14.342,19 13,17.656 13,16 13,14.344 14.342,13 16,13 17.658,13 19,14.344 19,16 19,17.656 17.658,19 16,19 M16,10C12.686,10 10,12.686 10,16 10,19.313 12.686,22 16,22 19.314,22 22,19.313 22,16 22,12.686 19.314,10 16,10" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </fluent:BackstageTabItem.Icon>
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10" HorizontalAlignment="Stretch">
                                    <Grid.Resources>
                                        <converters:DatabaseTypeStringConverter x:Key="DatabaseTypeStringConverter" />
                                        <converters:EmailAnonymizationTypeStringConverter x:Key="EmailAnonymizationTypeStringConverter" />

                                        <Style TargetType="TextBlock">
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                        </Style>

                                        <Style TargetType="TextBox">
                                            <Setter Property="Padding" Value="3" />
                                            <Setter Property="Margin" Value="0,3,0,3" />
                                        </Style>

                                        <Style TargetType="ComboBox">
                                            <Setter Property="Padding" Value="5" />
                                            <Setter Property="Margin" Value="0,3,0,3" />
                                        </Style>

                                        <Style TargetType="ComboBoxItem">
                                            <Setter Property="Padding" Value="3" />
                                        </Style>
                                    </Grid.Resources>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <!---->
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Style="{StaticResource HeadingTextBlockStyle}"
                                            Grid.ColumnSpan="2">Allgemein</TextBlock>

                                    <TextBlock Grid.Row="1">Geschlecht beibehalten</TextBlock>
                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                        <RadioButton IsChecked="{Binding Settings.KeepGender}" GroupName="keepGender">ja</RadioButton>
                                        <RadioButton IsChecked="{Binding Settings.KeepGender, Converter={StaticResource InverseBooleanConverter}}" GroupName="keepGender">nein</RadioButton>
                                    </StackPanel>

                                    <TextBlock Style="{StaticResource SubHeadingTextBlockStyle}"
                                           Grid.Row="2" Grid.ColumnSpan="2">E-Mail Einstellungen</TextBlock>

                                    <TextBlock Grid.Row="3">Format</TextBlock>
                                    <ComboBox Grid.Row="3" Grid.Column="1"
                                          ItemsSource="{Binding AnonymizationTypes}" SelectedItem="{Binding Settings.Email.Type}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource EmailAnonymizationTypeStringConverter}}" />
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>

                                    <TextBlock Grid.Row="4">Domain</TextBlock>
                                    <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding Settings.Email.Domain, UpdateSourceTrigger=PropertyChanged}" />

                                    <TextBlock Grid.Row="5">Länge</TextBlock>
                                    <xceed:IntegerUpDown Grid.Row="5" Grid.Column="1" Value="{Binding Settings.Email.RandomLength, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock Grid.Row="6" Grid.ColumnSpan="2" Style="{StaticResource HelpTextBlockStyle}">Länge der zufällig generierten E-Mail Adresse (der Teil vor dem @)</TextBlock>

                                    <TextBlock Style="{StaticResource SubHeadingTextBlockStyle}"
                                           Grid.Row="7" Grid.ColumnSpan="2">Verbindung zu SchILD</TextBlock>

                                    <TextBlock Grid.Row="8">Art der Datenbank</TextBlock>
                                    <ComboBox Grid.Row="8" Grid.Column="2" 
                                          ItemsSource="{Binding SchILDDatabaseTypes}" SelectedItem="{Binding Settings.SchILDConnection.Type}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource DatabaseTypeStringConverter}}"></TextBlock>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>

                                    <TextBlock Grid.Row="9">Verbindungszeichenfolge</TextBlock>
                                    <TextBox Grid.Row="9" Grid.Column="1" Text="{Binding Settings.SchILDConnection.ConnectionString, UpdateSourceTrigger=PropertyChanged}" />

                                    <Grid Grid.Row="10" Grid.ColumnSpan="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <fluent:Button Header="Verbindung testen" IsDefinitive="False"
                                               Command="{Binding TestSchILDConnectionCommand}"
                                               HorizontalAlignment="Left">
                                            <fluent:Button.LargeIcon>
                                                <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                                    <Rectangle Width="16" Height="16">
                                                        <Rectangle.Fill>
                                                            <DrawingBrush>
                                                                <DrawingBrush.Drawing>
                                                                    <DrawingGroup>
                                                                        <DrawingGroup.Children>
                                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M6,2L6,0 1,0 1,2 0,2 0,5 1,5 1,6 2,6 2,8 5,8 5,6 6,6 6,5 7,5 7,2z M11,16C8.149,16,6,14.71,6,13L6,7C6,5.29 8.149,4 11,4 13.851,4 16,5.29 16,7L16,13C16,14.71,13.851,16,11,16" />
                                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M11,8.3252C9.001,8.3252 7.675,7.5272 7.675,7.0002 7.675,6.4722 9.001,5.6752 11,5.6752 12.999,5.6752 14.325,6.4722 14.325,7.0002 14.325,7.5272 12.999,8.3252 11,8.3252 M11,5.0002C8.791,5.0002,7,5.8952,7,7.0002L7,13.0002C7,14.1042 8.791,15.0002 11,15.0002 13.209,15.0002 15,14.1042 15,13.0002L15,7.0002C15,5.8952,13.209,5.0002,11,5.0002" />
                                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M14.3252,7C14.3252,7.527 12.9992,8.325 11.0002,8.325 9.0012,8.325 7.6752,7.527 7.6752,7 7.6752,6.473 9.0012,5.675 11.0002,5.675 12.9992,5.675 14.3252,6.473 14.3252,7" />
                                                                            <GeometryDrawing Brush="#FF388934" Geometry="F1M1,3L1,4 2,4 2,5 3,5 3,7 4,7 4,5 5,5 5,4 6,4 6,3z M4,2L5,2 5,1 4,1z M2,1L3,1 3,2 2,2z" />
                                                                        </DrawingGroup.Children>
                                                                    </DrawingGroup>
                                                                </DrawingBrush.Drawing>
                                                            </DrawingBrush>
                                                        </Rectangle.Fill>
                                                    </Rectangle>
                                                </Viewbox>
                                            </fluent:Button.LargeIcon>
                                        </fluent:Button>

                                        <TextBlock Style="{StaticResource HelpTextBlockStyle}" Grid.Column="1"
                                               Visibility="{Binding IsConnectingSchILD, Converter={StaticResource BooleanToVisibilityConverter}}">Verbindung wird hergestellt...</TextBlock>
                                    </Grid>

                                    <TextBlock Style="{StaticResource SubHeadingTextBlockStyle}"
                                           Grid.Row="11" Grid.ColumnSpan="2">Verbindung zur internen Datenbank</TextBlock>

                                    <TextBlock Grid.Row="12">Art der Datenbank</TextBlock>
                                    <ComboBox Grid.Row="12" Grid.Column="2" 
                                          ItemsSource="{Binding InternalDatabaseTypes}" SelectedItem="{Binding Settings.DatabaseConnection.Type}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource DatabaseTypeStringConverter}}"></TextBlock>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>

                                    <TextBlock Grid.Row="13">Verbindungszeichenfolge</TextBlock>
                                    <TextBox Grid.Row="13" Grid.Column="1" Text="{Binding Settings.DatabaseConnection.ConnectionString, UpdateSourceTrigger=PropertyChanged}" />

                                    <Grid Grid.Row="14" Grid.ColumnSpan="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <fluent:Button Header="Verbindung testen" IsDefinitive="False"
                                               Command="{Binding TestDataSourceConnectionCommand}" HorizontalAlignment="Left">
                                            <fluent:Button.LargeIcon>
                                                <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                                    <Rectangle Width="32" Height="32">
                                                        <Rectangle.Fill>
                                                            <DrawingBrush>
                                                                <DrawingBrush.Drawing>
                                                                    <DrawingGroup>
                                                                        <DrawingGroup.Children>
                                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M6,2L6,0 1,0 1,2 0,2 0,5 1,5 1,6 2,6 2,8 5,8 5,6 6,6 6,5 7,5 7,2z M11,16C8.149,16,6,14.71,6,13L6,7C6,5.29 8.149,4 11,4 13.851,4 16,5.29 16,7L16,13C16,14.71,13.851,16,11,16" />
                                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M11,8.3252C9.001,8.3252 7.675,7.5272 7.675,7.0002 7.675,6.4722 9.001,5.6752 11,5.6752 12.999,5.6752 14.325,6.4722 14.325,7.0002 14.325,7.5272 12.999,8.3252 11,8.3252 M11,5.0002C8.791,5.0002,7,5.8952,7,7.0002L7,13.0002C7,14.1042 8.791,15.0002 11,15.0002 13.209,15.0002 15,14.1042 15,13.0002L15,7.0002C15,5.8952,13.209,5.0002,11,5.0002" />
                                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M14.3252,7C14.3252,7.527 12.9992,8.325 11.0002,8.325 9.0012,8.325 7.6752,7.527 7.6752,7 7.6752,6.473 9.0012,5.675 11.0002,5.675 12.9992,5.675 14.3252,6.473 14.3252,7" />
                                                                            <GeometryDrawing Brush="#FF388934" Geometry="F1M1,3L1,4 2,4 2,5 3,5 3,7 4,7 4,5 5,5 5,4 6,4 6,3z M4,2L5,2 5,1 4,1z M2,1L3,1 3,2 2,2z" />
                                                                        </DrawingGroup.Children>
                                                                    </DrawingGroup>
                                                                </DrawingBrush.Drawing>
                                                            </DrawingBrush>
                                                        </Rectangle.Fill>
                                                    </Rectangle>
                                                </Viewbox>
                                            </fluent:Button.LargeIcon>
                                        </fluent:Button>

                                        <fluent:Button Header="Verbindung neu aufbauen" IsDefinitive="False" Grid.Column="1"
                                               Command="{Binding ConnectDataSourceCommand}" HorizontalAlignment="Left">
                                            <fluent:Button.LargeIcon>
                                                <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                                    <Rectangle Width="16" Height="16">
                                                        <Rectangle.Fill>
                                                            <DrawingBrush>
                                                                <DrawingBrush.Drawing>
                                                                    <DrawingGroup>
                                                                        <DrawingGroup.Children>
                                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M11.5,7C11.329,7,11.165,7.027,11,7.048L11,3C11,1.29 8.851,0 6,0 3.149,0 1,1.29 1,3L1,9C1,10.711 3.149,12 6,12 6.36,12 6.709,11.979 7.044,11.939 7.269,14.215 9.165,16 11.5,16 13.985,16 16,13.985 16,11.5 16,9.015 13.985,7 11.5,7" />
                                                                            <GeometryDrawing Brush="#FF414141" Geometry="F1M2.6748,3C2.6748,2.473 4.0008,1.675 5.9998,1.675 7.9988,1.675 9.3248,2.473 9.3248,3 9.3248,3.527 7.9988,4.325 5.9998,4.325 4.0008,4.325 2.6748,3.527 2.6748,3 M9.9998,7.275L9.9998,6 9.9998,3C9.9998,2.496 9.6148,2.041 8.9998,1.689 8.2668,1.271 7.2008,1 5.9998,1 4.7988,1 3.7338,1.271 2.9998,1.689 2.3848,2.041 1.9998,2.496 1.9998,3L1.9998,6 1.9998,9C1.9998,10.104 3.7908,11 5.9998,11 6.3688,11 6.7188,10.967 7.0588,10.92 7.2788,9.223 8.4328,7.833 9.9998,7.275" />
                                                                            <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M6,1.6748C4.001,1.6748 2.675,2.4728 2.675,2.9998 2.675,3.5278 4.001,4.3248 6,4.3248 7.999,4.3248 9.325,3.5278 9.325,2.9998 9.325,2.4728 7.999,1.6748 6,1.6748" />
                                                                            <GeometryDrawing Brush="#FF329932" Geometry="F1M10,13L10,10 13.5,11.5z M11.5,8C9.567,8 8,9.567 8,11.5 8,13.433 9.567,15 11.5,15 13.433,15 15,13.433 15,11.5 15,9.567 13.433,8 11.5,8" />
                                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M10,10L13.5,11.5 10,13z" />
                                                                        </DrawingGroup.Children>
                                                                    </DrawingGroup>
                                                                </DrawingBrush.Drawing>
                                                            </DrawingBrush>
                                                        </Rectangle.Fill>
                                                    </Rectangle>
                                                </Viewbox>
                                            </fluent:Button.LargeIcon>
                                        </fluent:Button>

                                        <TextBlock Style="{StaticResource HelpTextBlockStyle}" Grid.Column="2"
                                               Visibility="{Binding IsConnectingInternal, Converter={StaticResource BooleanToVisibilityConverter}}">Verbindung wird hergestellt...</TextBlock>
                                    </Grid>

                                    <TextBlock Style="{StaticResource SubHeadingTextBlockStyle}"
                                           Grid.Row="15" Grid.ColumnSpan="2">SchulIT Idp Export</TextBlock>

                                    <TextBlock Grid.Row="16">URL</TextBlock>
                                    <TextBox Grid.Row="16" Grid.Column="1" Text="{Binding Settings.Export.SchulITIdp.Endpoint, UpdateSourceTrigger=PropertyChanged}"/>

                                    <TextBlock Grid.Row="17">Token</TextBlock>
                                    <TextBox Grid.Row="17" Grid.Column="1" Text="{Binding Settings.Export.SchulITIdp.Token, UpdateSourceTrigger=PropertyChanged}"/>

                                    <TextBlock Grid.Row="18">Anonymer Vorname</TextBlock>
                                    <TextBox Grid.Row="18" Grid.Column="1" Text="{Binding Settings.Export.SchulITIdp.FirstnameAttributeName, UpdateSourceTrigger=PropertyChanged}"/>

                                    <TextBlock Grid.Row="19">Anonymer Nachname</TextBlock>
                                    <TextBox Grid.Row="19" Grid.Column="1" Text="{Binding Settings.Export.SchulITIdp.LastnameAttributeName, UpdateSourceTrigger=PropertyChanged}"/>

                                    <TextBlock Grid.Row="20">Anonyme E-Mail Adresse</TextBlock>
                                    <TextBox Grid.Row="20" Grid.Column="1" Text="{Binding Settings.Export.SchulITIdp.EmailAttributeName, UpdateSourceTrigger=PropertyChanged}"/>
                                </Grid>
                            </ScrollViewer>
                        </fluent:BackstageTabItem>
                        <fluent:BackstageTabItem Header="Über">
                            <fluent:BackstageTabItem.Icon>
                                <!-- This file was generated by the AiToXaml tool.-->
                                <!-- Tool Version: 14.0.22307.0 -->
                                <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,8.0005C0,3.5825 3.582,0.000499999999998835 8,0.000499999999998835 12.418,0.000499999999998835 16,3.5825 16,8.0005 16,12.4185 12.418,16.0005 8,16.0005 3.582,16.0005 0,12.4185 0,8.0005" />
                                                            <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M9,5L7,5 7,3 9,3z M9,13L7,13 7,6 9,6z M8,1C4.135,1 1,4.135 1,8 1,11.865 4.135,15 8,15 11.865,15 15,11.865 15,8 15,4.135 11.865,1 8,1" />
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M7,5L9,5 9,3 7,3z M7,6L9,6 9,13 7,13z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </fluent:BackstageTabItem.Icon>
                            
                            <Grid DataContext="{Binding Source={StaticResource ViewModelLocator}, Path=About}"
                                  Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <TextBlock Style="{StaticResource HeadingTextBlockStyle}" Text="{Binding ApplicationName}" />
                                <TextBlock Style="{StaticResource HelpTextBlockStyle}" Grid.Row="1" Text="{Binding Version}" />
                                <TextBlock Grid.Row="2" Text="{Binding Copyright}" />
                                <TextBlock Grid.Row="3">
                                    <Hyperlink NavigateUri="{Binding ProjectUrl}" RequestNavigate="OnRequestNavigate">
                                        <TextBlock Text="{Binding ProjectUrl}" />
                                    </Hyperlink>
                                </TextBlock>

                                <TextBlock Grid.Row="4" TextWrapping="Wrap" Margin="0,10,0,10">
                                    Dieses Programm nutzt das <Hyperlink NavigateUri="https://github.com/kpreisser/TaskDialog" RequestNavigate="OnRequestNavigate">Task Dialog for .NET-Project</Hyperlink> von Konstantin Preißer.
                                </TextBlock>

                                <TextBlock Grid.Row="5" TextWrapping="Wrap" Margin="0,10,0,10">
                                    Dieses Programm nutzt Icons aus der <Hyperlink NavigateUri="https://www.microsoft.com/en-us/download/details.aspx?id=35825" RequestNavigate="OnRequestNavigate">Visual Studio Image Library</Hyperlink>.
                                </TextBlock>
                                
                                <TextBlock Grid.Row="6" TextWrapping="Wrap" Margin="0,10,0,10">
                                    Dieses Programm nutzt Bibliotheken von Drittanbietern. Diese sind im Folgenden aufgelistet. Besonderen Dank an die Entwickler dieser Bibliothken.
                                </TextBlock>

                                <ScrollViewer Grid.Row="7">
                                    <ItemsControl ItemsSource="{Binding Libraries}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,0,0,25">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Style="{StaticResource SubHeadingTextBlockStyle}">
                                                    <Hyperlink NavigateUri="{Binding PackageUrl}" RequestNavigate="OnRequestNavigate">
                                                        <TextBlock Text="{Binding PackageName}" />
                                                    </Hyperlink>
                                                </TextBlock>
                                                    <TextBlock Grid.Row="1" Style="{StaticResource HelpTextBlockStyle}" Text="{Binding Description}"
                                                           TextWrapping="Wrap" />
                                                    <TextBlock Grid.Row="2">
                                                    <Hyperlink NavigateUri="{Binding LicenseUrl}" RequestNavigate="OnRequestNavigate">
                                                        <TextBlock Text="Lizenz anzeigen" />
                                                    </Hyperlink>
                                                </TextBlock>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </Grid>
                        </fluent:BackstageTabItem>
                        <fluent:SeparatorTabItem />
                        <fluent:Button Header="Schließen" Click="OnCloseButtonClick"></fluent:Button>
                    </fluent:BackstageTabControl>
                </fluent:Backstage>
            </fluent:Ribbon.Menu>
            <fluent:RibbonTabItem Header="Start">
                <fluent:RibbonGroupBox Header="Datenbank">
                    <fluent:Button Header="Schüler aus DB laden" Command="{Binding LoadStudentsCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="Schüler aus DB laden"
                                              Text="Lädt alle Schüler aus der internen Datenbank." />
                        </fluent:Button.ToolTip>
                        
                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M6,2L6,0 1,0 1,2 0,2 0,5 1,5 1,6 2,6 2,8 5,8 5,6 6,6 6,5 7,5 7,2z M11,16C8.149,16,6,14.71,6,13L6,7C6,5.29 8.149,4 11,4 13.851,4 16,5.29 16,7L16,13C16,14.71,13.851,16,11,16" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M11,8.3252C9.001,8.3252 7.675,7.5272 7.675,7.0002 7.675,6.4722 9.001,5.6752 11,5.6752 12.999,5.6752 14.325,6.4722 14.325,7.0002 14.325,7.5272 12.999,8.3252 11,8.3252 M11,5.0002C8.791,5.0002,7,5.8952,7,7.0002L7,13.0002C7,14.1042 8.791,15.0002 11,15.0002 13.209,15.0002 15,14.1042 15,13.0002L15,7.0002C15,5.8952,13.209,5.0002,11,5.0002" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M14.3252,7C14.3252,7.527 12.9992,8.325 11.0002,8.325 9.0012,8.325 7.6752,7.527 7.6752,7 7.6752,6.473 9.0012,5.675 11.0002,5.675 12.9992,5.675 14.3252,6.473 14.3252,7" />
                                                        <GeometryDrawing Brush="#FF388934" Geometry="F1M1,3L1,4 2,4 2,5 3,5 3,7 4,7 4,5 5,5 5,4 6,4 6,3z M4,2L5,2 5,1 4,1z M2,1L3,1 3,2 2,2z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>

                    <fluent:Button Header="Schüler aus SchILD laden" Command="{Binding SyncCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="Schüler aus SchILD laden"
                                              Text="Lädt alle Schüler aus der SchILD-Datenbank." />
                        </fluent:Button.ToolTip>
                        
                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,9L16,16 7,16 7,10 4.005,10C1.878,9.737,0,7.782,0,5.677L0,4.559C0,4.127,0.260999999999999,3.717,0.468999999999999,3L0,3 0,1.674 1.79,0 5.995,0.016C8.031,0.170999999999999 9.343,1.674 9.809,3.453 10.312,3.173 10.883,3 11.5,3 13.434,3 15,4.566 15,6.5 15,7.48 14.65,8.365 14,9z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M10,4.5754L10,5.2304C9.945,5.7464,9.771,6.1714,9.531,7.0004L10,7.0004 10,8.3254 9.907,8.4124C10.341,8.7734 10.891,9.0004 11.5,9.0004 12.879,9.0004 14,7.8804 14,6.5004 14,5.1204 12.879,4.0004 11.5,4.0004 10.931,4.0004 10.413,4.1974 9.992,4.5174 9.994,4.5374 9.999,4.5564 10,4.5754 M15,10.0004L15,15.0004 8,15.0004 8,10.0004 8.198,10.0004 10,10.0004 11.5,12.0004 13,10.0004z" />
                                                        <GeometryDrawing Brush="#FF00529C" Geometry="F1M2.0664,5.2672C2.0664,4.1332,2.7734,3.1652,3.7704,2.7792L3.8004,5.0002 5.0004,3.8002 5.0004,1.0002 2.2004,1.0002 1.0004,2.0002 2.4784,2.0002C1.6004,3.0002 1.0004,3.8842 1.0004,5.1002 1.0004,6.9232 2.2994,8.5372 4.0004,8.9452L4.0004,7.8092C2.8874,7.4892,2.0664,6.4822,2.0664,5.2672 M7.5214,8.0002L9.0004,8.0002 7.8004,9.0002 5.0004,9.0002 5.0004,6.2002 6.2004,5.0002 6.2294,7.2212C7.2264,6.8342 7.9334,5.8662 7.9334,4.7332 7.9334,3.5172 7.1134,2.5102 6.0004,2.1902L6.0004,1.0552C7.7004,1.4622 9.0004,3.0772 9.0004,4.9002 9.0004,6.1152 8.4004,7.0002 7.5214,8.0002" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>

                    <fluent:Button Header="Alte Schüler löschen" Command="{Binding RemoveNonActiveStudentsCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="Alte Schüler löschen"
                                              Text="Löscht alle Schüler, die nicht mehr in SchILD vorhanden sind, aus der internen Datenbank." />
                        </fluent:Button.ToolTip>

                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,9L16,16 7,16 7,9 8.225,9 5.111,6.295 3.063,8.544C2.7,8.911 2.253,9.13 1.779,9.13 1.305,9.13 0.856999999999999,8.942 0.519,8.601 -0.178000000000001,7.894 -0.178000000000001,6.789 0.519,6.082L2.762,4.108 1.646,3.067C0.928000000000001,2.34 0.93,1.208 1.622,0.516 1.943,0.192 2.409,0.00399999999999956 2.898,0.00399999999999956 3.399,0.00399999999999956 3.866,0.208 4.178,0.563000000000001L5.22,1.956 7.709,0 10.666,0 7.128,4.09 8.19,5.413C8.649,4.015 9.949,3 11.5,3 13.434,3 15,4.566 15,6.5 15,7.48 14.65,8.365 14,9z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M13,10L11.5,12 10,10 8,10 8,15 15,15 15,10z M11.5,4C12.879,4 14,5.12 14,6.5 14,7.881 12.879,9 11.5,9 11.339,9 11.183,8.982 11.031,8.953L9.007,6.431C9.044,5.084,10.143,4,11.5,4" />
                                                        <GeometryDrawing Brush="#FFA1260C" Geometry="F1M5.834,4.1294L8.5,1.0004 8.055,1.0004 5.032,3.3754 3.427,1.2234C3.152,0.910400000000001 2.598,0.9524 2.329,1.2234 2.051,1.5014 1.995,1.9984 2.329,2.3364L4.25,4.1294 1.23,6.7854C0.923999999999999,7.0954 0.923999999999999,7.5874 1.23,7.8974 1.537,8.2074 2.021,8.2074 2.329,7.8974L5.042,4.9584 8.605,8.1254 9,8.1254z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>

                    <fluent:Button Header="Ausgewählte Schüler löschen" Command="{Binding RemoveSelectedStudentsCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="Ausgewählte Schüler löschen"
                                              Text="Löscht alle ausgewählten Schüler aus der internen Datenbank." />
                        </fluent:Button.ToolTip>

                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,9L16,16 7,16 7,9 8.225,9 5.111,6.295 3.063,8.544C2.7,8.911 2.253,9.13 1.779,9.13 1.305,9.13 0.856999999999999,8.942 0.519,8.601 -0.178000000000001,7.894 -0.178000000000001,6.789 0.519,6.082L2.762,4.108 1.646,3.067C0.928000000000001,2.34 0.93,1.208 1.622,0.516 1.943,0.192 2.409,0.00399999999999956 2.898,0.00399999999999956 3.399,0.00399999999999956 3.866,0.208 4.178,0.563000000000001L5.22,1.956 7.709,0 10.666,0 7.128,4.09 8.19,5.413C8.649,4.015 9.949,3 11.5,3 13.434,3 15,4.566 15,6.5 15,7.48 14.65,8.365 14,9z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M13,10L11.5,12 10,10 8,10 8,15 15,15 15,10z M11.5,4C12.879,4 14,5.12 14,6.5 14,7.881 12.879,9 11.5,9 11.339,9 11.183,8.982 11.031,8.953L9.007,6.431C9.044,5.084,10.143,4,11.5,4" />
                                                        <GeometryDrawing Brush="#FFA1260C" Geometry="F1M5.834,4.1294L8.5,1.0004 8.055,1.0004 5.032,3.3754 3.427,1.2234C3.152,0.910400000000001 2.598,0.9524 2.329,1.2234 2.051,1.5014 1.995,1.9984 2.329,2.3364L4.25,4.1294 1.23,6.7854C0.923999999999999,7.0954 0.923999999999999,7.5874 1.23,7.8974 1.537,8.2074 2.021,8.2074 2.329,7.8974L5.042,4.9584 8.605,8.1254 9,8.1254z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Anonymisierung">
                    <fluent:Button Header="Ausgewählte Schüler anonymisieren" Command="{Binding AnonymizeSelectedStudentsCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="Ausgewählte Schüler anonymisieren"
                                              Text="Erzeugt für alle ausgewählten Schüler anonyme Identitäten. Falls ein Schüler bereits eine anonyme Identität besitzt, wird keien neue generiert." />
                        </fluent:Button.ToolTip>

                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="32" Height="32">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M29,10L24.5,10C25.453,8.938 26,7.539 26,6 26,2.686 23.314,0 20,0 16.687,0 14,2.686 14,6 14,7.539 14.548,8.938 15.5,10L11,10 11,14.268C10.37,14.094 9.7,14 9,14 5.328,14 2.439,16.619 2,20L2,32 16,32 16,24 29,24z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M9,16C6.256,16,4.299,17.709,4,20L6,20C6.279,18.945 7.311,18 9,18 10.641,18 11.705,18.94 12,20L14,20C13.721,17.707,11.746,16,9,16 M8,28L10,28 10,24 8,24z M4,22L14,22 14,30 4,30z M21,18.001C21,17.447 20.551,17 20,17 19.447,17 19,17.447 19,18.001 19,18.553 19.447,19 20,19 20.551,19 21,18.553 21,18.001 M27,12L27,22 16,22 16,20C15.756,17.99,14.638,16.261,13,15.181L13,12 17,12 20,15 23,12z M16,6C16,3.792 17.791,2 20,2 22.207,2 24,3.792 24,6 24,8.208 22.207,10 20,10 17.791,10 16,8.208 16,6" />
                                                        <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M8,28L10,28 10,24 8,24z M21,18.001C21,18.553 20.551,19 20,19 19.447,19 19,18.553 19,18.001 19,17.447 19.447,17 20,17 20.551,17 21,17.447 21,18.001" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>

                    <fluent:Button Header="Alle Schüler anonymisieren" Command="{Binding AnonymizeCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="Alle Schüler anonymisieren"
                                              Text="Erzeugt für alle Schüler anonyme Identitäten. Falls ein Schüler bereits eine anonyme Identität besitzt, wird keien neue generiert." />
                        </fluent:Button.ToolTip>
                        
                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="32" Height="32">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M29,10L24.5,10C25.453,8.938 26,7.539 26,6 26,2.686 23.314,0 20,0 16.687,0 14,2.686 14,6 14,7.539 14.548,8.938 15.5,10L11,10 11,14.268C10.37,14.094 9.7,14 9,14 5.328,14 2.439,16.619 2,20L2,32 16,32 16,24 29,24z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M9,16C6.256,16,4.299,17.709,4,20L6,20C6.279,18.945 7.311,18 9,18 10.641,18 11.705,18.94 12,20L14,20C13.721,17.707,11.746,16,9,16 M8,28L10,28 10,24 8,24z M4,22L14,22 14,30 4,30z M21,18.001C21,17.447 20.551,17 20,17 19.447,17 19,17.447 19,18.001 19,18.553 19.447,19 20,19 20.551,19 21,18.553 21,18.001 M27,12L27,22 16,22 16,20C15.756,17.99,14.638,16.261,13,15.181L13,12 17,12 20,15 23,12z M16,6C16,3.792 17.791,2 20,2 22.207,2 24,3.792 24,6 24,8.208 22.207,10 20,10 17.791,10 16,8.208 16,6" />
                                                        <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M8,28L10,28 10,24 8,24z M21,18.001C21,18.553 20.551,19 20,19 19.447,19 19,18.553 19,18.001 19,17.447 19.447,17 20,17 20.551,17 21,17.447 21,18.001" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>
                <fluent:RibbonGroupBox Header="Export">
                    <fluent:Button Header="CSV Export" Command="{Binding ExportCsvCommand}">
                        <fluent:Button.ToolTip>
                            <fluent:ScreenTip Title="CSV Export"
                                              Text="Exportiert die angezeigten Daten in CSV-Dateien. Diese können bspw. mit Excel weiterverarbeitet werden. Pro Klasse wird eine CSV-Datei erzeugt. Vorhandene Dateien werden überschrieben." />
                        </fluent:Button.ToolTip>
                        
                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M10.0605,1L6.4145,1 5.4145,0 0.5855,0 2.3795,1.793C2.3325,1.856,2.2975,1.93,2.2575,2L-0.000500000000000611,2 -0.000500000000000611,6 1.9995,6 1.9995,6.586 0.5855,8 1.9995,8 1.9995,13C1.9995,14.299,3.0305,15,3.9995,15L11.9995,15C13.2985,15,13.9995,13.97,13.9995,13L13.9995,4.556z" />
                                                        <GeometryDrawing Brush="#FF414141" Geometry="F1M5,10L10.999,10 10.999,9 5,9z" />
                                                        <GeometryDrawing Brush="#FF414141" Geometry="F1M5,12L10.999,12 10.999,10.999 5,10.999z" />
                                                        <GeometryDrawing Brush="#FF414141" Geometry="F1M9.6406,2L7.4136,2 8.4136,3 8.9996,3 8.9996,3.586 9.4136,4 8.9996,4.414 8.9996,6 11.9996,6 11.9996,13 3.9996,13 3.9996,8 2.9996,8 2.9996,13C2.9996,14,3.9646,14,3.9646,14L11.9646,14C12.9646,14,12.9996,13,12.9996,13L12.9996,5z" />
                                                        <GeometryDrawing Brush="#FF414141" Geometry="F1M7.4141,6L8.0001,6 8.0001,5.414z" />
                                                        <GeometryDrawing Brush="#FF414141" Geometry="F1M6.4141,7L5.4141,8 11.0001,8 11.0001,7z" />
                                                        <GeometryDrawing Brush="#FF00529C" Geometry="F1M5,1L3,1 5,3 1,3 1,5 5,5 3,7 5,7 8,4z" />
                                                        <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M11,10L5,10 5,9 11,9z M11,12L5,12 5,11 11,11z M9,6L9,4.414 8,5.414 8,6 7.414,6 6.414,7 11,7 11,8 5.414,8 5,8 4,8 4,13 12,13 12,6z" />
                                                        <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M8.4141,3.0004L9.0001,3.5864 9.0001,3.0004z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>
                    <fluent:Button Header="SchulIT Idp Export" Command="{Binding ExportSchulITIdpCommand}">
                        <fluent:Button.LargeIcon>
                            <Viewbox Width="32" Height="32" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,9.2803C16,10.1543,15.688,11.0043,15.12,11.6743L14.46,12.4513C14.236,14.4473 12.546,16.0003 10.491,16.0003 8.62,16.0003 7.054,14.7133 6.619,12.9743L3.868,12.9743C1.727,12.9373 0,11.1723 0,9.0383 0,7.4293 0.943,6.0253 2.362,5.4173 2.852,3.4293 4.61,2.0013 6.693,2.0013 7.833,2.0013 8.9,2.4263 9.716,3.1893 10.011,3.1123 10.317,3.0723 10.624,3.0723 12.399,3.0723 13.881,4.3753 14.178,6.0843 15.29,6.7373 16,7.9503 16,9.2803" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M15.0137,9.2803C15.0137,9.9473 14.7697,10.5563 14.3687,11.0273 14.2677,10.6233 14.1077,10.2463 13.8927,9.9003 13.9217,9.8263 13.9397,9.7483 13.9567,9.6693 13.9727,9.6023 13.9887,9.5273 13.9977,9.4403 13.9977,9.4293 13.9997,9.4203 13.9997,9.4103 14.0057,9.3543 14.0097,9.2953 14.0117,9.2333 13.9927,8.3173 13.2617,7.5773 12.3557,7.5773 12.2207,7.5773 12.0917,7.5973 11.9687,7.6293 12.1407,7.3663 12.2427,7.0503 12.2427,6.7103 12.2427,5.8033 11.5217,5.0693 10.6327,5.0693 9.9457,5.0693 9.3657,5.5093 9.1327,6.1263 8.9447,4.9233 7.9307,4.0013 6.6987,4.0013 5.3357,4.0013 4.2307,5.1283 4.2307,6.5193 4.2307,6.7373 4.2657,6.9433 4.3167,7.1443 4.1817,7.1133 4.0427,7.0923 3.8967,7.0923 2.8497,7.0923 1.9997,7.9583 1.9997,9.0263 1.9997,10.0863 2.8357,10.9413 3.8707,10.9573L3.8707,10.9593 6.6417,10.9593C6.6287,11.0063 6.6167,11.0523 6.6047,11.1013 6.5937,11.1523 6.5817,11.2013 6.5717,11.2523 6.5567,11.3323 6.5467,11.4123 6.5357,11.4923 6.5307,11.5353 6.5227,11.5783 6.5187,11.6213 6.5077,11.7383 6.5017,11.8553 6.5017,11.9743L3.8707,11.9743C2.2807,11.9473 0.999700000000001,10.6313 0.999700000000001,9.0383 0.999700000000001,7.6453 1.9617,6.4753 3.2467,6.1763 3.4197,4.3953 4.9017,3.0013 6.6987,3.0013 7.8077,3.0013 8.8037,3.5253 9.4397,4.3623 9.8007,4.1753 10.2067,4.0723 10.6327,4.0723 12.0727,4.0723 13.2427,5.2593 13.2427,6.7163L13.2427,6.7413C14.2737,7.1123,15.0137,8.1103,15.0137,9.2803" />
                                                        <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M3.8711,10.959L3.8711,10.957C2.8361,10.941 2.0001,10.086 2.0001,9.026 2.0001,7.958 2.8501,7.093 3.8961,7.093 4.0431,7.093 4.1821,7.113 4.3161,7.145 4.2661,6.943 4.2301,6.737 4.2301,6.52 4.2301,5.128 5.3351,4.001 6.6991,4.001 7.9311,4.001 8.9451,4.923 9.1331,6.126 9.3651,5.51 9.9451,5.069 10.6331,5.069 11.5211,5.069 12.2421,5.804 12.2421,6.71 12.2421,7.05 12.1411,7.366 11.9691,7.629 12.0921,7.598 12.2211,7.577 12.3551,7.577 13.2711,7.577 14.0141,8.335 14.0141,9.268 14.0141,9.325 14.0041,9.38 13.9981,9.437 13.6931,9.081 13.3281,8.783 12.9201,8.551L9.5001,5.729 9.5001,8.128C8.1111,8.486,7.0131,9.575,6.6381,10.959z" />
                                                        <GeometryDrawing Brush="#FF00539C" Geometry="F1M13.5,12C13.5,13.656 12.158,15 10.5,15 8.843,15 7.5,13.656 7.5,12 7.5,10.344 8.843,9.001 10.5,9.001L10.5,7.851 12.5,9.501 10.5,11.15 10.5,10C9.396,10 8.5,10.896 8.5,12 8.5,13.105 9.396,14 10.5,14 11.605,14 12.5,13.105 12.5,12 12.5,11.895 12.486,11.791 12.469,11.689L13.418,11.309C13.471,11.531,13.5,11.762,13.5,12" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </fluent:Button.LargeIcon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>
            </fluent:RibbonTabItem>
        </fluent:Ribbon>
        <fluent:StatusBar DockPanel.Dock="Bottom">
            <fluent:StatusBarItem HorizontalAlignment="Left" Padding="5,0">
                <TextBlock>
                    <Run Text="{Binding Students.Count, Mode=OneWay}"></Run>
                    <Run Text=" Schüler"></Run>
                </TextBlock>
            </fluent:StatusBarItem>

            <Separator HorizontalAlignment="Left" />
            
            <fluent:StatusBarItem HorizontalAlignment="Right" Margin="10,0,10,0" Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}">
                <StackPanel Orientation="Horizontal">
                    <ProgressBar Height="10" Width="50" Value="{Binding BusyProgress, Converter={StaticResource NullToZeroConverter}}" IsIndeterminate="{Binding BusyProgress, Converter={StaticResource IsNullConverter}}" />
                    <TextBlock Text="{Binding BusyMessage}" Margin="10,0,0,0" />
                </StackPanel>
            </fluent:StatusBarItem>
        </fluent:StatusBar>

        <Border DockPanel.Dock="Top" Background="DarkRed" Padding="5" Visibility="{Binding IsNotPersistentDatabase, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Foreground="White" TextWrapping="Wrap">Die aktuellen Änderungen werden nicht gespeichert. Zum persistieren der anonymen Identitäten muss eine Verbindung zu einer persistenten Datenbank erstellt werden.</TextBlock>
        </Border>

        
        
        <ListView ItemsSource="{Binding Source={StaticResource GroupedStudents}}" IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBooleanConverter}}"
                  VirtualizingPanel.IsVirtualizingWhenGrouping="True">
            <b:Interaction.Behaviors>
                <behaviors:SelectedItemsBehavior SelectedItems="{Binding SelectedStudents}" />
            </b:Interaction.Behaviors>
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="" Width="22">
                        <GridViewColumn.CellTemplateSelector>
                            <selectors:BooleanStateDataTemplateSelector>
                                <selectors:BooleanStateDataTemplateSelector.TrueTemplate>
                                    <DataTemplate>
                                        <Viewbox Margin="-4,0,0,0" Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                                     ToolTip="Schüler ist nicht mehr in der SchILD-Datenbank vorhanden.">
                                            <Rectangle Width="16" Height="16">
                                                <Rectangle.Fill>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Children>
                                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M7.5254,10.8418L3.6074,15.1658C3.1354,15.6428 2.5314,15.8908 1.8744,15.8848 0.688400000000001,15.8748 0.000399999999999956,14.4528 0.000399999999999956,14.4528L0.000399999999999956,11.9998 4.4144,7.9568 2.1594,5.7018C1.1424,4.6728 1.3394,3.1068 2.1594,2.2878 2.5784,1.8658 3.2314,1.6118 3.9034,1.6118 4.5894,1.6118 5.2144,1.8758 5.6184,2.3358L7.5004,4.9998 12.5414,1.4948 15.5004,1.4998 10.1744,8.0418 16.0004,15.9998 14.0004,15.9998z" />
                                                                    <GeometryDrawing Brush="#FFA1260D" Geometry="F1M14.4629,14.9883L13.9629,14.9953 7.5359,9.4473 2.9629,14.4953C2.4249,15.0353 1.4629,14.9953 0.962899999999999,14.4953 0.462899999999999,13.9953 0.4239,13.0373 0.962899999999999,12.4953L5.9629,7.9953 2.9629,4.9953C2.3789,4.4033 2.4759,3.4823 2.9629,2.9953 3.4339,2.5203 4.4829,2.4483 4.9629,2.9953L7.4629,6.4953 12.4999,2.5003 13.4999,2.5003 8.9629,7.9953z" />
                                                                </DrawingGroup.Children>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Rectangle.Fill>
                                            </Rectangle>
                                        </Viewbox>
                                    </DataTemplate>
                                </selectors:BooleanStateDataTemplateSelector.TrueTemplate>

                                <selectors:BooleanStateDataTemplateSelector.FalseTemplate>
                                    <DataTemplate>
                                        <Viewbox Margin="-4,0,0,0" Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                                     ToolTip="Schüler ist in der SchILD-Datenbank vorhanden.">
                                            <Rectangle Width="16" Height="16">
                                                <Rectangle.Fill>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Children>
                                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M4.3818,15L0.3818,7 5.6178,7 6.4998,8.764 10.3818,1 15.6178,1 8.6178,15z" />
                                                                    <GeometryDrawing Brush="#FF414141" Geometry="F1M11,2L6.5,11 5,8 2,8 5,14 8,14 14,2z" />
                                                                </DrawingGroup.Children>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Rectangle.Fill>
                                            </Rectangle>
                                        </Viewbox>
                                    </DataTemplate>
                                </selectors:BooleanStateDataTemplateSelector.FalseTemplate>

                                <selectors:BooleanStateDataTemplateSelector.NullTemplate>
                                    <DataTemplate>
                                        <Viewbox Margin="-4,0,0,0" Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                                     ToolTip="Es ist unbekannt, ob der Schüler in der SchILD-Datenbank vorhanden ist.">
                                            <Rectangle Width="16" Height="16">
                                                <Rectangle.Fill>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Children>
                                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M10,14L6,14 6,9C6,8.232,6.29,7.531,6.765,7L4,7 4,5C4,3.262 5.682,2 8,2 10.316,2 12,3.262 12,5L12,7C12,8.304,11.164,9.416,10,9.828z" />
                                                                    <GeometryDrawing Brush="#FF414141" Geometry="F1M9,11L7,11 7,13 9,13z M9,10L7,10 7,9C7,7.897,7.897,7,9,7L9,5.203C8.84,5.115 8.495,5 8,5 7.504,5 7.159,5.115 7,5.203L7,6 5,6 5,5C5,3.841 6.261,3 8,3 9.738,3 11,3.841 11,5L11,7C11,8.103,10.102,9,9,9z" />
                                                                </DrawingGroup.Children>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Rectangle.Fill>
                                            </Rectangle>
                                        </Viewbox>
                                    </DataTemplate>
                                </selectors:BooleanStateDataTemplateSelector.NullTemplate>
                            </selectors:BooleanStateDataTemplateSelector>
                        </GridViewColumn.CellTemplateSelector>
                    </GridViewColumn>
                    <GridViewColumn Header="SchILD-ID" DisplayMemberBinding="{Binding SchILDId}" />
                    <GridViewColumn Header="Nachname" DisplayMemberBinding="{Binding LastName}" />
                    <GridViewColumn Header="Vorname" DisplayMemberBinding="{Binding FirstName}" />
                    <GridViewColumn Header="E-Mail Adresse" DisplayMemberBinding="{Binding Email}" />
                    <GridViewColumn Header="Klasse" DisplayMemberBinding="{Binding Grade}" />
                    <GridViewColumn Header="anon. Nachname" DisplayMemberBinding="{Binding AnonymousLastName}" />
                    <GridViewColumn Header="anon. Vorname" DisplayMemberBinding="{Binding AnonymousFirstName}" />
                    <GridViewColumn Header="anon. E-Mail Adresse" DisplayMemberBinding="{Binding AnonymousEmail}" />
                </GridView>
            </ListView.View>

            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.ContainerStyle>
                        <Style TargetType="GroupItem">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <Expander IsExpanded="True">
                                            <Expander.Header>
                                                <TextBlock Text="{Binding Name}" Style="{StaticResource ListViewGroupHeaderStyle}" />
                                            </Expander.Header>

                                            <ItemsPresenter />
                                        </Expander>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GroupStyle.ContainerStyle>
                </GroupStyle>
            </ListView.GroupStyle>
        </ListView>
    </DockPanel>
</fluent:RibbonWindow>
